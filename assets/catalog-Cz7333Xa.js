(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function n(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(o){if(o.ep)return;o.ep=!0;const r=n(o);fetch(o.href,r)}})();const m="2609725f661288e9b08bc0d62455b671",y="https://api.themoviedb.org/3";async function k(e=1){return await(await fetch(`${y}/movie/popular?api_key=${m}&page=${e}`)).json()}async function _(){return await(await fetch(`${y}/trending/movie/day?api_key=${m}`)).json()}async function S(){return await(await fetch(`${y}/trending/movie/week?api_key=${m}`)).json()}async function $(){return await(await fetch(`${y}/movie/upcoming?api_key=${m}`)).json()}async function x(e,t=""){return await(await fetch(`${y}/search/movie?api_key=${m}&query=${encodeURIComponent(e)}&year=${t}`)).json()}async function C(){return await(await fetch(`${y}/genre/movie/list?api_key=${m}`)).json()}let f=null;async function E(){if(f)return f;const e=await C();return f={},e.genres&&Array.isArray(e.genres)&&e.genres.forEach(t=>{f[t.id]=t.name}),f}function L(){const e=localStorage.getItem("library");return e?JSON.parse(e):[]}function A(e){localStorage.setItem("library",JSON.stringify(e))}function q(e,t){let n=L();const i=e.id;n.includes(i)?(n=n.filter(o=>o!==i),t.textContent="Add to library",t.classList.remove("removed")):(n.push(i),t.textContent="Remove from my library",t.classList.add("removed")),A(n)}function M(e,t){L().includes(e.id)?(t.textContent="Remove from my library",t.classList.add("removed")):(t.textContent="Add to library",t.classList.remove("removed"))}async function P(e){let t=document.querySelector("#popup-template");if(!t){const i=window.location.hostname==="localhost";let o;i?o="/popup.html":o=`/${window.location.pathname.split("/")[1]}/popup.html`,fetch(o).then(r=>{if(!r.ok)throw console.error(`Popup.html yüklenemedi. Durum: ${r.status}, URL: ${r.url}`),new Error("Network response was not ok.");return r.text()}).then(async r=>{const a=document.createElement("div");a.innerHTML=r;const s=a.querySelector(".movie-popup-overlay");s?(s.id="popup-template",document.body.appendChild(s),await v(s,e)):console.error("movie-popup-overlay bulunamadı, HTML içeriği yanlış olabilir.")}).catch(r=>{console.error("Popup yüklenirken bir hata oluştu:",r)});return}const n=t.cloneNode(!0);n.id="",await v(n,e)}async function v(e,t){e.style.display="flex";const n=e.querySelector(".movie-popup-img");n.src=t.poster_path?`https://image.tmdb.org/t/p/original${t.poster_path}`:"",n.alt=t.title,e.querySelector(".movie-popup-title").textContent=t.title;const i=t.vote_average!=null?t.vote_average.toFixed(1):"-";e.querySelector(".vote-avg").textContent=i,e.querySelector(".vote-count").textContent=t.vote_count??"-";const o=t.popularity!=null?t.popularity.toFixed(1):"-";e.querySelector(".popularity-value").textContent=o;let r="-";if(t.genre_names&&Array.isArray(t.genre_names))r=t.genre_names.join(", ");else if(t.genre_ids&&Array.isArray(t.genre_ids)){const u=await E();r=t.genre_ids.map(c=>u[c]||c).join(", ")}e.querySelector(".genre-value").textContent=r,e.querySelector(".about-value").textContent=t.overview||"No description.";const a=e.querySelector(".movie-popup-add-btn");a&&(M(t,a),a.addEventListener("click",function(){q(t,this)}));const s=e.querySelector(".movie-popup-close");s.addEventListener("mouseenter",()=>{s.querySelector("img").src="../img/svg/close-hover.svg"}),s.addEventListener("mouseleave",()=>{s.querySelector("img").src="../img/svg/close.svg"}),s.addEventListener("click",()=>e.remove()),e.addEventListener("mousedown",function(u){u.target===e&&e.remove()}),document.body.appendChild(e)}console.log("catalog.js yüklendi!");const w=document.getElementById("search-form"),d=document.getElementById("movie-list"),l=document.getElementById("no-results"),g=document.getElementById("year-select");function B(){d.addEventListener("click",e=>{const t=e.target.closest("li.movie-item");if(!t)return;const n=Array.from(d.children).indexOf(t),o=Array.from(d.children).map(r=>r._movieData).filter(Boolean)[n];o&&P(o)})}function b(e){if(d.innerHTML="",!e||e.length===0){l.style.display="block";return}l.style.display="none",e.slice(0,21).forEach(n=>{const i=document.createElement("li");i.classList.add("movie-item"),i.innerHTML=`
      <img src="https://image.tmdb.org/t/p/original${n.poster_path}" alt="${n.title}" />
      <h3>${n.title}</h3>
      <p>Yayın Tarihi: ${n.release_date||"Bilinmiyor"}</p>
    `,i._movieData=n,d.appendChild(i)})}function D(){const e=new Date().getFullYear();for(let t=e;t>=1900;t--){const n=document.createElement("option");n.value=t,n.textContent=t,g.appendChild(n)}}async function I(){if(console.log("initCatalog fonksiyonu çağrıldı!"),!w||!d||!l||!g){console.error("Catalog için gerekli DOM elemanları bulunamadı!");return}D();try{const[e,t,n,i]=await Promise.all([k(),_(),S(),$()]);console.log("API verileri geldi:",{popularData:e,dailyData:t,weeklyData:n,upcomingData:i});const o=[...e.results,...t.results,...n.results,...i.results];console.log("Birleştirilmiş film listesi:",o);const r=new Map;o.forEach(a=>{r.has(a.id)||r.set(a.id,a)}),console.log("Benzersiz filmler:",Array.from(r.values())),b(Array.from(r.values())),w.addEventListener("submit",async a=>{a.preventDefault();let s=document.getElementById("search-input").value.trim(),u=g.value;if(s)try{const c=await x(s);console.log("Arama sonuçları:",c);let p=c.results;u&&(p=p.filter(h=>h.release_date&&h.release_date.startsWith(u))),b(p),p.length===0&&(l.style.display="block",l.textContent="Aradığınız kriterlere uygun film bulunamadı.")}catch(c){console.error("Film arama hatası:",c),l.style.display="block",l.textContent="Film bulunamadı veya bir hata oluştu."}})}catch(e){console.error("Filmler yüklenirken hata:",e),l.style.display="block",l.textContent="Filmler yüklenirken hata oluştu."}}I();B();export{I as i};
//# sourceMappingURL=catalog-Cz7333Xa.js.map
