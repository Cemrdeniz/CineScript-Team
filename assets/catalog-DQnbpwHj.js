(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function r(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(n){if(n.ep)return;n.ep=!0;const o=r(n);fetch(n.href,o)}})();const u="2609725f661288e9b08bc0d62455b671",m="https://api.themoviedb.org/3";async function q(e=1){return await(await fetch(`${m}/movie/popular?api_key=${u}&page=${e}`)).json()}async function _(){return await(await fetch(`${m}/trending/movie/day?api_key=${u}`)).json()}async function x(){return await(await fetch(`${m}/trending/movie/week?api_key=${u}`)).json()}async function A(){return await(await fetch(`${m}/movie/upcoming?api_key=${u}`)).json()}async function P(e){return await(await fetch(`${m}/movie/${e}/videos?api_key=${u}`)).json()}async function T(e,t=""){return await(await fetch(`${m}/search/movie?api_key=${u}&query=${encodeURIComponent(e)}&year=${t}`)).json()}async function B(){return await(await fetch(`${m}/genre/movie/list?api_key=${u}`)).json()}const c=document.createElement("div");c.classList.add("trailer-modal","is-hidden");c.innerHTML=`
  <div class="trailer-modal-backdrop">
    <div class="trailer-modal-content">
      <button class="trailer-modal-close">&times;</button>
      <iframe
        id="trailer-video"
        width="100%"
        height="100%"
        frameborder="0"
        allowfullscreen
        allow="autoplay; encrypted-media"
      ></iframe>
    </div>
  </div>
`;document.body.appendChild(c);const I=c.querySelector(".trailer-modal-close"),L=c.querySelector(".trailer-modal-backdrop"),M=c.querySelector("#trailer-video");function N(e){M.src=`https://www.youtube.com/embed/${e}?autoplay=1`,c.classList.remove("is-hidden")}function b(){c.classList.add("is-hidden"),M.src=""}I.addEventListener("click",b);L.addEventListener("click",e=>{e.target===L&&b()});document.addEventListener("keydown",e=>{e.key==="Escape"&&!c.classList.contains("is-hidden")&&b()});const D=document.querySelector(".catalog-hero-title"),j=document.querySelector(".catalog-hero-overview"),F=document.querySelector(".catalog-hero-btn.trailer"),R=document.querySelector(".catalog-hero-btn.details"),H=document.querySelector(".catalog-hero");let v=null;async function U(){try{const t=(await _()).results,r=t[Math.floor(Math.random()*t.length)];v=r.id;const n=`https://image.tmdb.org/t/p/original${r.backdrop_path||r.poster_path}`;H.style.backgroundImage=`url(${n})`,D.textContent=r.title||r.name||"Untitled",j.textContent=r.overview||"No description available"}catch(e){console.error("Error loading hero section:",e)}}async function Y(){if(v)try{const r=(await P(v)).results.find(a=>a.type==="Trailer"&&a.site==="YouTube");r?N(r.key):alert("No trailer available.")}catch(e){console.error("Trailer error:",e)}}F.addEventListener("click",Y);R.addEventListener("click",()=>{alert("More details tıklanıldı!")});U();let g=null;async function z(){if(g)return g;const e=await B();return g={},e.genres&&Array.isArray(e.genres)&&e.genres.forEach(t=>{g[t.id]=t.name}),g}function C(){const e=localStorage.getItem("library");return e?JSON.parse(e):[]}function G(e){localStorage.setItem("library",JSON.stringify(e))}function J(e,t){let r=C();const a=e.id;r.includes(a)?(r=r.filter(n=>n!==a),t.textContent="Add to library",t.classList.remove("removed")):(r.push(a),t.textContent="Remove from my library",t.classList.add("removed")),G(r)}function K(e,t){C().includes(e.id)?(t.textContent="Remove from my library",t.classList.add("removed")):(t.textContent="Add to library",t.classList.remove("removed"))}async function V(e){let t=document.querySelector("#popup-template");if(!t){const a=window.location.hostname==="localhost";let n;a?n="/popup.html":n=`/${window.location.pathname.split("/")[1]}/popup.html`,fetch(n).then(o=>{if(!o.ok)throw console.error(`Popup.html yüklenemedi. Durum: ${o.status}, URL: ${o.url}`),new Error("Network response was not ok.");return o.text()}).then(async o=>{const i=document.createElement("div");i.innerHTML=o;const s=i.querySelector(".movie-popup-overlay");s?(s.id="popup-template",document.body.appendChild(s),await S(s,e)):console.error("movie-popup-overlay bulunamadı, HTML içeriği yanlış olabilir.")}).catch(o=>{console.error("Popup yüklenirken bir hata oluştu:",o)});return}const r=t.cloneNode(!0);r.id="",await S(r,e)}async function S(e,t){e.style.display="flex";const r=e.querySelector(".movie-popup-img");r.src=t.poster_path?`https://image.tmdb.org/t/p/original${t.poster_path}`:"",r.alt=t.title,e.querySelector(".movie-popup-title").textContent=t.title;const a=t.vote_average!=null?t.vote_average.toFixed(1):"-";e.querySelector(".vote-avg").textContent=a,e.querySelector(".vote-count").textContent=t.vote_count??"-";const n=t.popularity!=null?t.popularity.toFixed(1):"-";e.querySelector(".popularity-value").textContent=n;let o="-";if(t.genre_names&&Array.isArray(t.genre_names))o=t.genre_names.join(", ");else if(t.genre_ids&&Array.isArray(t.genre_ids)){const p=await z();o=t.genre_ids.map(k=>p[k]||k).join(", ")}e.querySelector(".genre-value").textContent=o,e.querySelector(".about-value").textContent=t.overview||"No description.";const i=e.querySelector(".movie-popup-add-btn");i&&(K(t,i),i.addEventListener("click",function(){J(t,this)}));const s=e.querySelector(".movie-popup-close"),h=window.location.hostname==="localhost",y=h?"":window.location.pathname.split("/")[1],d=h?"":`/${y}`;s.addEventListener("mouseenter",()=>{s.querySelector("img").src=`${d}/img/svg/close-hover.svg`}),s.addEventListener("mouseleave",()=>{s.querySelector("img").src=`${d}/img/svg/close.svg`}),s.addEventListener("click",()=>e.remove()),e.addEventListener("mousedown",function(p){p.target===e&&e.remove()}),document.body.appendChild(e)}console.log("catalog.js yüklendi!");const E=document.getElementById("search-form"),f=document.getElementById("movie-list"),l=document.getElementById("no-results"),w=document.getElementById("year-select");function W(){f.addEventListener("click",e=>{const t=e.target.closest("li.movie-item");if(!t)return;const r=Array.from(f.children).indexOf(t),n=Array.from(f.children).map(o=>o._movieData).filter(Boolean)[r];n&&V(n)})}function $(e){if(f.innerHTML="",!e||e.length===0){l.style.display="block";return}l.style.display="none",e.slice(0,21).forEach(r=>{const a=document.createElement("li");a.classList.add("movie-item"),a.innerHTML=`
      <img src="https://image.tmdb.org/t/p/original${r.poster_path}" alt="${r.title}" />
      <h3>${r.title}</h3>
      <p>Yayın Tarihi: ${r.release_date||"Bilinmiyor"}</p>
    `,a._movieData=r,f.appendChild(a)})}function Q(){const e=new Date().getFullYear();for(let t=e;t>=1900;t--){const r=document.createElement("option");r.value=t,r.textContent=t,w.appendChild(r)}}async function X(){if(console.log("initCatalog fonksiyonu çağrıldı!"),!E||!f||!l||!w){console.error("Catalog için gerekli DOM elemanları bulunamadı!");return}Q();try{const[e,t,r,a]=await Promise.all([q(),_(),x(),A()]);console.log("API verileri geldi:",{popularData:e,dailyData:t,weeklyData:r,upcomingData:a});const n=[...e.results,...t.results,...r.results,...a.results];console.log("Birleştirilmiş film listesi:",n);const o=new Map;n.forEach(i=>{o.has(i.id)||o.set(i.id,i)}),console.log("Benzersiz filmler:",Array.from(o.values())),$(Array.from(o.values())),E.addEventListener("submit",async i=>{i.preventDefault();let s=document.getElementById("search-input").value.trim(),h=w.value;if(s)try{const y=await T(s);console.log("Arama sonuçları:",y);let d=y.results;h&&(d=d.filter(p=>p.release_date&&p.release_date.startsWith(h))),$(d),d.length===0&&(l.style.display="block",l.textContent="Aradığınız kriterlere uygun film bulunamadı.")}catch(y){console.error("Film arama hatası:",y),l.style.display="block",l.textContent="Film bulunamadı veya bir hata oluştu."}})}catch(e){console.error("Filmler yüklenirken hata:",e),l.style.display="block",l.textContent="Filmler yüklenirken hata oluştu."}}X();W();export{X as i};
//# sourceMappingURL=catalog-DQnbpwHj.js.map
