(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function o(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function a(n){if(n.ep)return;n.ep=!0;const r=o(n);fetch(n.href,r)}})();const y="2609725f661288e9b08bc0d62455b671",f="https://api.themoviedb.org/3";async function k(e=1){return await(await fetch(`${f}/movie/popular?api_key=${y}&page=${e}`)).json()}async function _(){return await(await fetch(`${f}/trending/movie/day?api_key=${y}`)).json()}async function S(){return await(await fetch(`${f}/trending/movie/week?api_key=${y}`)).json()}async function x(){return await(await fetch(`${f}/movie/upcoming?api_key=${y}`)).json()}async function C(e,t=""){return await(await fetch(`${f}/search/movie?api_key=${y}&query=${encodeURIComponent(e)}&year=${t}`)).json()}async function E(){return await(await fetch(`${f}/genre/movie/list?api_key=${y}`)).json()}let g=null;async function A(){if(g)return g;const e=await E();return g={},e.genres&&Array.isArray(e.genres)&&e.genres.forEach(t=>{g[t.id]=t.name}),g}function $(){const e=localStorage.getItem("library");return e?JSON.parse(e):[]}function q(e){localStorage.setItem("library",JSON.stringify(e))}function M(e,t){let o=$();const a=e.id;o.includes(a)?(o=o.filter(n=>n!==a),t.textContent="Add to library",t.classList.remove("removed")):(o.push(a),t.textContent="Remove from my library",t.classList.add("removed")),q(o)}function P(e,t){$().includes(e.id)?(t.textContent="Remove from my library",t.classList.add("removed")):(t.textContent="Add to library",t.classList.remove("removed"))}async function B(e){let t=document.querySelector("#popup-template");if(!t){const a=window.location.hostname==="localhost";let n;a?n="/popup.html":n=`/${window.location.pathname.split("/")[1]}/popup.html`,fetch(n).then(r=>{if(!r.ok)throw console.error(`Popup.html yüklenemedi. Durum: ${r.status}, URL: ${r.url}`),new Error("Network response was not ok.");return r.text()}).then(async r=>{const i=document.createElement("div");i.innerHTML=r;const s=i.querySelector(".movie-popup-overlay");s?(s.id="popup-template",document.body.appendChild(s),await w(s,e)):console.error("movie-popup-overlay bulunamadı, HTML içeriği yanlış olabilir.")}).catch(r=>{console.error("Popup yüklenirken bir hata oluştu:",r)});return}const o=t.cloneNode(!0);o.id="",await w(o,e)}async function w(e,t){e.style.display="flex";const o=e.querySelector(".movie-popup-img");o.src=t.poster_path?`https://image.tmdb.org/t/p/original${t.poster_path}`:"",o.alt=t.title,e.querySelector(".movie-popup-title").textContent=t.title;const a=t.vote_average!=null?t.vote_average.toFixed(1):"-";e.querySelector(".vote-avg").textContent=a,e.querySelector(".vote-count").textContent=t.vote_count??"-";const n=t.popularity!=null?t.popularity.toFixed(1):"-";e.querySelector(".popularity-value").textContent=n;let r="-";if(t.genre_names&&Array.isArray(t.genre_names))r=t.genre_names.join(", ");else if(t.genre_ids&&Array.isArray(t.genre_ids)){const d=await A();r=t.genre_ids.map(v=>d[v]||v).join(", ")}e.querySelector(".genre-value").textContent=r,e.querySelector(".about-value").textContent=t.overview||"No description.";const i=e.querySelector(".movie-popup-add-btn");i&&(P(t,i),i.addEventListener("click",function(){M(t,this)}));const s=e.querySelector(".movie-popup-close"),p=window.location.hostname==="localhost",u=p?"":window.location.pathname.split("/")[1],c=p?"":`/${u}`;s.addEventListener("mouseenter",()=>{s.querySelector("img").src=`${c}/img/svg/close-hover.svg`}),s.addEventListener("mouseleave",()=>{s.querySelector("img").src=`${c}/img/svg/close.svg`}),s.addEventListener("click",()=>e.remove()),e.addEventListener("mousedown",function(d){d.target===e&&e.remove()}),document.body.appendChild(e)}console.log("catalog.js yüklendi!");const b=document.getElementById("search-form"),m=document.getElementById("movie-list"),l=document.getElementById("no-results"),h=document.getElementById("year-select");function D(){m.addEventListener("click",e=>{const t=e.target.closest("li.movie-item");if(!t)return;const o=Array.from(m.children).indexOf(t),n=Array.from(m.children).map(r=>r._movieData).filter(Boolean)[o];n&&B(n)})}function L(e){if(m.innerHTML="",!e||e.length===0){l.style.display="block";return}l.style.display="none",e.slice(0,21).forEach(o=>{const a=document.createElement("li");a.classList.add("movie-item"),a.innerHTML=`
      <img src="https://image.tmdb.org/t/p/original${o.poster_path}" alt="${o.title}" />
      <h3>${o.title}</h3>
      <p>Yayın Tarihi: ${o.release_date||"Bilinmiyor"}</p>
    `,a._movieData=o,m.appendChild(a)})}function I(){const e=new Date().getFullYear();for(let t=e;t>=1900;t--){const o=document.createElement("option");o.value=t,o.textContent=t,h.appendChild(o)}}async function N(){if(console.log("initCatalog fonksiyonu çağrıldı!"),!b||!m||!l||!h){console.error("Catalog için gerekli DOM elemanları bulunamadı!");return}I();try{const[e,t,o,a]=await Promise.all([k(),_(),S(),x()]);console.log("API verileri geldi:",{popularData:e,dailyData:t,weeklyData:o,upcomingData:a});const n=[...e.results,...t.results,...o.results,...a.results];console.log("Birleştirilmiş film listesi:",n);const r=new Map;n.forEach(i=>{r.has(i.id)||r.set(i.id,i)}),console.log("Benzersiz filmler:",Array.from(r.values())),L(Array.from(r.values())),b.addEventListener("submit",async i=>{i.preventDefault();let s=document.getElementById("search-input").value.trim(),p=h.value;if(s)try{const u=await C(s);console.log("Arama sonuçları:",u);let c=u.results;p&&(c=c.filter(d=>d.release_date&&d.release_date.startsWith(p))),L(c),c.length===0&&(l.style.display="block",l.textContent="Aradığınız kriterlere uygun film bulunamadı.")}catch(u){console.error("Film arama hatası:",u),l.style.display="block",l.textContent="Film bulunamadı veya bir hata oluştu."}})}catch(e){console.error("Filmler yüklenirken hata:",e),l.style.display="block",l.textContent="Filmler yüklenirken hata oluştu."}}N();D();export{N as i};
//# sourceMappingURL=catalog-DXyntPUH.js.map
